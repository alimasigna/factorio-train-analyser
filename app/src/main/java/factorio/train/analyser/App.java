/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package factorio.train.analyser;

import java.util.ArrayList;

import factorio.train.analyser.analyser.Deadlock_Analyser;
import factorio.train.analyser.decoder.Decoder;
import factorio.train.analyser.graph.Graph;
import factorio.train.analyser.graph.Node;
import factorio.train.analyser.graph.Section;
import factorio.train.analyser.graph.Track;
import factorio.train.analyser.jsonmodels.Entity;
import factorio.train.analyser.jsonmodels.Position;

public class App {

    private static final String blueprint = "0eNqV1O1qwyAUBuB7Ob9NqYnx61bKGGkrnZCYoHYsBO99JtnGSsc4/vTjPIovngXO/d1M3roIegF7GV0AfVog2Jvr+nUuzpMBDTaaAQi4blhHvrM9JALWXc0HaJpeCBgXbbRmr98G86u7D2fj84afyhBz7e0tVhtBYBpDrhrdelSWuCAwg65qlfWr9eayL9aJPKE1GlV4tMGiguJRhkYbPNqi0RaPcjRaEJRAowVBSSwqC4JSaLQgKHpEqwVJUfSfkgVR0frhj1dffeA5KXb4vqs4tI8u/8ttcK48FroM6bb/ubl7bf1N/2qHBN6ND/tDScqEqoVkquGKp/QJJ2Wz2A==";

    public String decode() {
        Matrix matrix = new Matrix(blueprint);
        Graph graph = new Graph(blueprint);
        graph.getClass();
        Decoder decoder = new Decoder();
        String decodedString = decoder.decode(blueprint);
        Deadlock_Analyser analyser = new Deadlock_Analyser(graph);
        ArrayList<ArrayList<Node>> result = analyser.deadlockCheck();
        return (decodedString + "\n" + matrix);
        //Matrix matrix_copy = matrix;
        //return deadlockmatrix(matrix_copy, result);
    }
/*
    private String deadlockmatrix(Matrix matrix_blueprint, ArrayList<ArrayList<Section>> deadlocks) {
        String result = "";
        for (ArrayList<Section> deadlock : deadlocks) {
            if (deadlock.size() > 1) {
                ArrayList<Position> positions = new ArrayList<Position>();
                for (Section section : deadlock) {
                    for (Node node : section.getNodes()) {
                        for (Track track : node.getTracks()) {
                            positions.add(track.getPosition());
                        }
                    }

                }
                ArrayList<Entity>[][] matrix_entities = matrix_blueprint.getMatrix();
                for (ArrayList<Entity>[] arrayLists : matrix_entities) {
                    for (ArrayList<Entity> arrayList : arrayLists) {
                        if (arrayList != null) {
                            for (int i = 0; i < arrayList.size(); i++) {
                                for (int j = 0; j < positions.size(); j++) {
                                    if (arrayList.get(i).getPosition().getX() == positions.get(j).getX()
                                            && arrayList.get(i).getPosition().getY() == positions.get(j).getY()) {
                                        continue;
                                    } else if (j == positions.size() - 1
                                            && !(arrayList.get(i).getPosition().getX() == positions.get(j).getX())) {
                                        arrayList.remove(i);
                                    }
                                }
                            }
                        }
                    }
                }
                Matrix deadlockMatrix = new Matrix();
                deadlockMatrix.overrideMatrix(matrix_entities);
                System.out.println("\n" + "------" + "\n" + deadlockMatrix.toString());
            } else {
                System.out.println("\n" + "------" + "\n" + "no deadlock");
            }
        }
        return result;
    }
*/
    public static void main(String[] args) {
        System.out.println(new App().decode());
    }
}
